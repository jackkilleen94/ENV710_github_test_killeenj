---
title: "Summary_Statistics"
output:
  pdf_document: default
  html_document: default
---

```{r setup, include=FALSE}
library(tidyverse)
```

```{r load-data}
# Load data
data <- read_csv("Rosie's Docs/Combined Final Dataframe.csv")
```

```{r summary-stats}
# Summary statistics
summary(data)

library(skimr)
skim(data)
```

```{r}
library(ggplot2)
library(dplyr)
library(maps)

data_clean <- data %>%
  mutate(region = tolower(State))

states_map <- map_data("state")

# Merge map data
map_data_joined <- left_join(states_map, data_clean, by = "region")

# Plot
ggplot(map_data_joined, aes(x = long, y = lat, group = group, fill = EV_ratio)) +
  geom_polygon(color = "white") +
  coord_fixed(1.3) +
  labs(title = "EVs per Capita by State", fill = "EVs per Capita") +
  theme_void()
```

```{r}
library(ggplot2)
library(dplyr)
library(maps)
library(gridExtra)

# Prepare data
data_clean <- data %>% mutate(region = tolower(State))
states_map <- map_data("state")
map_data_joined <- left_join(states_map, data_clean, by = "region")

# Urbanization map
urban_map <- ggplot(map_data_joined, aes(x = long, y = lat, group = group, fill = Urbanization)) +
  geom_polygon(color = "white") +
  coord_fixed(1.3) +
  scale_fill_continuous(name = "Urban %", low = "#deebf7", high = "#08519c") +
  labs(title = "Urbanization by State") +
  theme_void()

# EVs per capita map
ev_map <- ggplot(map_data_joined, aes(x = long, y = lat, group = group, fill = EV_ratio)) +
  geom_polygon(color = "white") +
  coord_fixed(1.3) +
  scale_fill_continuous(name = "EVs per Capita", low = "#fee5d9", high = "#a50f15") +
  labs(title = "EVs per Capita by State") +
  theme_void()

# Display side-by-side
gridExtra::grid.arrange(urban_map, ev_map, ncol = 2)
```

```{r}
library(ggrepel)

ggplot(data, aes(x = Urbanization, y = EV_ratio, label = State)) +
  geom_point(color = "#1f77b4", size = 3) +
  geom_text_repel(size = 3) +
  geom_smooth(method = "lm", se = FALSE, color = "black") +
  labs(title = "Urbanization vs EVs per Capita by State",
       x = "% Urban Population",
       y = "EVs per Capita") +
  theme_minimal()
```

```{r}
model_pm25 <- lm(PM.2.5 ~ EV_ratio + Urbanization + Temp_F + Precip_in, data = data)
summary(model_pm25)
```

