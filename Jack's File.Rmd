---
title: "Summary_Statistics"
output:
  pdf_document: default
  html_document: default
---

```{r setup, include=FALSE}
library(tidyverse)
library(ggplot2)
library(dplyr)
library(maps)
library(skimr)
```

```{r load-data}
# Load data
data <- read_csv("Rosie's Docs/Combined Final Dataframe.csv")
```

# Summary Statistics

```{r summary-stats}
# Summary statistics
summary(data)
skim(data)
```

# Exploratory Data Visuals

```{r State Map}
data_clean <- data %>%
  mutate(region = tolower(State))

states_map <- map_data("state")

# Merge map data
map_data_joined <- left_join(states_map, data_clean, by = "region")

# Plot
ggplot(map_data_joined, aes(x = long, y = lat, group = group, fill = EV_ratio)) +
  geom_polygon(color = "white") +
  coord_fixed(1.3) +
  labs(title = "EVs per Capita by State", fill = "EVs per Capita") +
  theme_void()
```



```{r Maps of Urbanization and EV Ratio by States}
library(ggplot2)
library(dplyr)
library(maps)
library(gridExtra)

# Prepare data
data_clean <- data %>% mutate(region = tolower(State))
states_map <- map_data("state")
map_data_joined <- left_join(states_map, data_clean, by = "region")

# Urbanization map
urban_map <- ggplot(map_data_joined, aes(x = long, y = lat, group = group, fill = Urbanization)) +
  geom_polygon(color = "white") +
  coord_fixed(1.3) +
  scale_fill_continuous(name = "Urban %", low = "#deebf7", high = "#08519c") +
  labs(title = "Urbanization by State") +
  theme_void()

# EVs per capita map
ev_map <- ggplot(map_data_joined, aes(x = long, y = lat, group = group, fill = EV_ratio)) +
  geom_polygon(color = "white") +
  coord_fixed(1.3) +
  scale_fill_continuous(name = "EVs per Capita", low = "#fee5d9", high = "#a50f15") +
  labs(title = "EVs per Capita by State") +
  theme_void()

# Display side-by-side
gridExtra::grid.arrange(urban_map, ev_map, ncol = 2)
```

```{r Scatterplot Urbanization and EV ratio}
library(ggrepel)

ggplot(data, aes(x = Urbanization, y = EV_ratio, label = State)) +
  geom_point(color = "#1f77b4", size = 3) +
  geom_text_repel(size = 3) +
  geom_smooth(method = "lm", se = FALSE, color = "black") +
  labs(title = "Urbanization vs EVs per Capita by State",
       x = "% Urban Population",
       y = "EVs per Capita") +
  theme_minimal()
```


## Dependent Variables Histograms 

```{r PM2.5 Value Distribution}
ggplot(data, aes(x = PM.2.5)) +
  geom_histogram(bins = 10, fill = "blue", color = "black") +
  ggtitle("Distribution of PM.2.5 Concentration Value (PPB)") +
  xlab("Values") +
  ylab("Frequency")
```


```{r Log transform PM2.5 values the graph again}
data$log_pm2.5 <- log(data$PM.2.5)
ggplot(data, aes(x = log_pm2.5)) +
  geom_histogram(bins = 10, fill = "blue", color = "black") +
  ggtitle("Distribution of Log Transformed PM.2.5 Concentration Value (PPB)") +
  xlab("Values") +
  ylab("Frequency")
```
> Since the original data of PM2.5 displays some level of left-skewness, I attempted to log-transform the PM2.5 values, but the distribution stil displays a left-skewness. We can experiment this with regressions later too.



```{r Distrbution of NO2 Concentrations}
data$NO2 <- as.numeric(data$NO2)

ggplot(data, aes(x = NO2)) +
  geom_histogram(bins = 10, fill = "purple", color = "black") +
  ggtitle("Distribution of NO2 Concentration Value (PPB)") +
  xlab("Values") +
  ylab("Frequency")
```



```{r}
data$Ozone_ppm <- as.numeric(data$Ozone_ppm)
ggplot(data, aes(x = Ozone_ppm)) +
  geom_histogram(bins = 10, fill = "orange", color = "black") +
  ggtitle("Distribution of Ozone Concentration Value (PPM)") +
  xlab("Values") +
  ylab("Frequency")
```
> The concentration values (parts per billion) of NO2 and Ozone (parts per million) are closer to normal distribution. 
> The two values in Ozone concentration histograms may appear to be outliers according to the histogram grouping, but we decided not to remove them because of small range of values.

## Independent Variables Histograms




# Regressions

```{r Original PM2.5}
model_pm25 <- lm(PM.2.5 ~ EV_ratio + Urbanization + Temp_F + Precip_in, data = data)
summary(model_pm25)
```

```{r Log-transformed PM2.5}

```

